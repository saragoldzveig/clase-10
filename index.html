<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Clase 10</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
        <link href="https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chartist/0.11.4/chartist.min.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/chartist/0.11.4/chartist.min.js"></script>
        <style>
            body {
                font-family: "Chivo", sans-serif;
                font-weight: 200;
                color: #06122c;
            }

            em {
                font-style: normal;
                font-weight: bold;
                text-decoration: underline;
            }
            span {
                font-weight: bolder;
            }
            .ct-series-a .ct-line,
            .ct-series-a .ct-point {
                stroke: #ff1b82;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="row">
                <div class="col-md-9 col-lg-6 mx-auto py-5">
                    <h1 class="lead display-4 my-2">Memorias en el ámbito de Moda</h1>

                    <h2 class="fs-6 lead mb-5">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-robot" viewBox="0 0 16 16">
                           
                            <path
                                d="M10.5 3.5a2.5 2.5 0 0 0-5 0V4h5zm1 0V4H15v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4h3.5v-.5a3.5 3.5 0 1 1 7 0M14 14V5H2v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1M8 7.993c1.664-1.711 5.825 1.283 0 5.132-5.825-3.85-1.664-6.843 0-5.132"
                            />
                        </svg>
                        Sara Goldzveig
                    </h2>

                    <p class="lead">
                        Se ve una repetición de la temática de género e identidad, en los proyectos dirigidos por la profesora Paola Moreno en el campo del diseño de moda, que se destaca por su enfoque unificado en la exploración y
                        representación de dicha temática.
                    </p>

                    <body>
                        <body class="bg-light">
                            <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
                                <symbol id="pdf" viewBox="0 0 16 16">
                                    <path
                                        fill-rule="evenodd"
                                        d="M4 0h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2m.165 11.668c.09.18.23.343.438.419.207.075.412.04.58-.03.318-.13.635-.436.926-.786.333-.401.683-.927 1.021-1.51a11.6 11.6 0 0 1 1.997-.406c.3.383.61.713.91.95.28.22.603.403.934.417a.86.86 0 0 0 .51-.138c.155-.101.27-.247.354-.416.09-.181.145-.37.138-.563a.84.84 0 0 0-.2-.518c-.226-.27-.596-.4-.96-.465a5.8 5.8 0 0 0-1.335-.05 11 11 0 0 1-.98-1.686c.25-.66.437-1.284.52-1.794.036-.218.055-.426.048-.614a1.24 1.24 0 0 0-.127-.538.7.7 0 0 0-.477-.365c-.202-.043-.41 0-.601.077-.377.15-.576.47-.651.823-.073.34-.04.736.046 1.136.088.406.238.848.43 1.295a20 20 0 0 1-1.062 2.227 7.7 7.7 0 0 0-1.482.645c-.37.22-.699.48-.897.787-.21.326-.275.714-.08 1.103"
                                    />
                                </symbol>
                            </svg>
                            <div class="container-fluid">
                                <img src="https://raw.githubusercontent.com/saragoldzveig/clase-10/main/img/moda01.png" alt="proyecto de título de Trinidad Murtagh" />
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="py-5">
                                                <h3 class="ms-2 fs-6"></h3>

                                                <div class="col-md-12">
                                                    <div class="card my-2 shadow-sm">
                                                        <div class="card-header fs-4">Memorias guiadas por Paola Moreno</div>
                                                        <div class="card-body">
                                                            <div class="table-responsive">
                                                                <table class="table table-hover small">
                                                                    <thead class="table-">
                                                                        <tr>
                                                                            <th scope="col" class="text-center">#</th>
                                                                            <th scope="col" style="width: 20%;">Autor(a)</th>
                                                                            <th scope="col">Año</th>
                                                                            <th scope="col" style="width: 40%;">Título</th>
                                                                            <th scope="col">Ámbito</th>
                                                                            <th scope="col">Prof. Guía</th>
                                                                            <th scope="col" class="text-center">Nota</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody></tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="mx-auto p-2">
                                                    <div class="card my-3 shadow-sm">
                                                        <div class="card-header fs-4">Progresión del promedio generale los proyectos de título guiados por la Paola Moreno</div>
                                                        <div class="py-5">  
                                                        <div class="mx-auto p-2">                                                     
                                                        <div class="ct-chart ct-major-tenth"></div>
                                                        <div>
                                                        <p>
                                                            Lorem ips dolor sit amet, consectetur adipisci elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostr exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur.
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        </div>
                                        </div>
                                        </div>
                                        <div class="col-md-12">
                                        <div class="card my-4 shadow-sm">
                                            <div class="card-header fs-4">Palabras habituales</div>
                                            <div class="card-body">
                                                    <canvas id="myChart"></canvas>
                                                    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                                                    <script>
                                                        const palabrasClaveFrecuencia = {
                                                            género: 5,
                                                            mujer: 3,
                                                            expresión: 3,
                                                            identidad: 6,
                                                            nuestro: 4,
                                                        };

                                                        const data = {
                                                            labels: Object.keys(palabrasClaveFrecuencia),
                                                            datasets: [
                                                                {
                                                                    data: Object.values(palabrasClaveFrecuencia),
                                                                    backgroundColor: ["rgba(255, 20, 147, 0.8)", "rgba(255, 89, 164, 0.7)", "rgba(255, 151, 193, 0.7)", "rgba(255, 178, 208, 0.7)", "rgba(255, 217, 231, 0.5)"],
                                                                    borderColor: ["rgba(255, 255, 255, 1)", "rgba(255, 255, 255, 1)", "rgba(255, 255, 255, 1)", "rgba(255, 255, 255, 1)", "rgba(255, 255, 255, 1)"],
                                                                    borderWidth: 1,
                                                                },
                                                            ],
                                                        };

                                                        const config = {
                                                            type: "doughnut",
                                                            data: data,
                                                        };

                                                        const ctx = document.getElementById("myChart").getContext("2d");

                                                        const myChart = new Chart(ctx, config);
                                                    </script>
                                                    <div class="mx-auto p-2">
                                                        <p>
                                                            Se observa la utilización recurrente de palabras clave relacionadas con la temática de género e identidad en varios proyectos de título guiados por la profesora. Esta repetición
                                                            sugiere que estos temas son importantes y recurrentes en los proyectos que ella supervisa. Esta consistencia temática también puede indicar una orientación particular de la
                                                            enseñanza o intereses investigativos de la profesora y sus estudiantes.
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        </div>
                                        <div class="col-md-12">
                                                <div class="mx-auto p-2">
                                                    <div class="card my-3 shadow-sm">
                                                        <div class="card-header fs-4">Proyectos de género e identidad</div>
                                                        <div class="py-5">  
                                                        <div class="mx-auto p-2">
                                                        <div>
                                                        <p>
                                                            Lorem ips dolor sit amet, consectetur adipisci elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostr exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur.
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        </div>
                                        </div>
                                        </div>
                                        <script>
                                            const aqui = document.querySelector("tbody");
                                            const visualizacion = document.querySelector("#aqui");
                                            const palabreo = document.querySelector("#palabreo");

                                            async function datos(criterio) {
                                                var seleccion = [];
                                                var profes = [];
                                                var nombres = [];
                                                var barras = [];
                                                var ambitos = [];
                                                const consulta = await fetch("https://raw.githubusercontent.com/profesorfaco/dno097-2024/main/clase-06/data.json");
                                                const data = await consulta.json();
                                                console.log("Lo que sigue son todos los datos:");
                                                console.log(data);
                                                //Trabajando con 1400 elementos en el arreglo
                                                data.forEach((d) => {
                                                    d.nota_titulo = parseFloat(d.nota_titulo.replace(",", "."));
                                                    d.nota_pga = parseFloat(d.nota_pga.replace(",", "."));
                                                    d.nota_seminario = parseFloat(d.nota_seminario.replace(",", "."));
                                                    d.year = Number(d.year);
                                                    d.pdf_ok = Number(d.pdf_ok);
                                                    d.ambito = d.ambito.replace("Entrenimiento", "Entretenimiento");
                                                    if (d.ambito.includes(criterio) && d.pdf_ok == 1) {
                                                        seleccion.push(d);
                                                    }
                                                });
                                                console.log("Lo que sigue es una selección de los datos:");
                                                console.log(seleccion);
                                                //Trabajando con una selección
                                                seleccion.forEach((s, i) => {
                                                    if (s.nombre_guia === "MORENO, P.") {
                                                        aqui.innerHTML += `<tr><td class="text-center">${i + 1}</td><td>${s.nombre_paterno} ${s.nombre_materno}, ${s.nombre_pila[0]}.</td><td>${
                                                            s.year
                                                        }</td><td><a href="https://diseno.uc.cl/memorias/pdf/${s.nombre_pdf}" class="link-dark">${s.nombre_proyecto}</a> <svg width="1em" height="1em"><use href="#pdf"></use></svg></td><td>${
                                                            s.ambito
                                                        }</td><td>${s.nombre_guia}</td><td class="text-center">${s.nota_titulo.toFixed(1)}</td></tr>`;
                                                        let obj = {};
                                                        obj["prof"] = `${s.nombre_guia}`;
                                                        obj["nota"] = `${s.nota_titulo.toFixed(1)}`;
                                                        profes.push(obj);
                                                        nombres.push(s.nombre_guia);
                                                    }
                                                });

                                                /*
                    En el seleccion.forEach hice 3 cosas
                    1ra. llenar el tbody
                    2da. empujar objetos a la variable profes
                    3ra. empujar strings a la variable nombres
                */
                                                console.log("Lo que sigue son sólo los nombres, sin repetir:");
                                                nombres = [...new Set(nombres)].sort();
                                                console.log(nombres);
                                                //Basándome en nombres, trabajo con profes
                                                nombres.forEach((x) => {
                                                    //prof sin repetir
                                                    let unProf = profes.filter((p) => p.prof === x);
                                                    //promedio de notas de cada prof
                                                    let average = unProf.reduce((a, b) => a + Number(b.nota), 0) / unProf.length;
                                                    let obj = {};
                                                    obj["prof"] = x;
                                                    obj["promedio"] = Number(average);
                                                    barras.push(obj);
                                                });
                                                console.log("Lo que sigue son promedios para cada nombre:");
                                                console.log(barras);
                                                //Forma más "clásica" de sacar promedio
                                                var i = 0;
                                                var total = 0;
                                                barras.forEach((barra) => {
                                                    total += barra.promedio;
                                                    i++;
                                                });
                                                var corte = total / i;
                                                document.querySelector("#corte").innerHTML = corte.toFixed(2);
                                                var ajuste = 0;
                                                let mayor = 0;
                                                barras.forEach((x) => {
                                                    mayor = Math.max(mayor, x.promedio);
                                                    if (x.promedio >= corte) {
                                                        visualizacion.innerHTML += `<g transform="translate(0 ${ajuste * 3})"><rect x="0" y="0" height="2" width="70" fill="#eee"></rect><rect x="0" y="0" height="2" width="${
                                                            x.promedio.toFixed(1) * 10
                                                        }" fill="#3274d7"></rect><text fill="white" font-size="1.2" x="0.5" y="1.4">${x.prof}</text><text fill="#06122c" font-size="1.2" x="${
                                                            x.promedio.toFixed(1) * 10 - 2.5
                                                        }" y="1.4">${x.promedio.toFixed(1)}</text></g>`;
                                                        ajuste++;
                                                    }
                                                });
                                                visualizacion.innerHTML += `<line x1="${mayor.toFixed(1) * 10}" y1="0" x2="${mayor.toFixed(1) * 10}" y2="${ajuste * 3}" stroke="white" stroke-width="0.1"/>`;
                                                var proporcion = "0 0 70 " + ajuste * 3;
                                                visualizacion.setAttribute("viewBox", proporcion);
                                                //Buscando las palabras frecuentes del "para qué" en su selección
                                                var words = "";
                                                seleccion.forEach((s) => (words = words + " " + s.para_que));
                                                var palabras = words.split(" ");
                                                palabras = palabras.sort();
                                                const nopalabras = [
                                                    "",
                                                    "a",
                                                    "al",
                                                    "así",
                                                    "como",
                                                    "con",
                                                    "de",
                                                    "De",
                                                    "del",
                                                    "dentro",
                                                    "desde",
                                                    "e",
                                                    "el",
                                                    "El",
                                                    "en",
                                                    "entre",
                                                    "esta",
                                                    "este",
                                                    "esto",
                                                    "estos",
                                                    "fin",
                                                    "hacia",
                                                    "la",
                                                    "las",
                                                    "le",
                                                    "les",
                                                    "lo",
                                                    "los",
                                                    "más",
                                                    "mediante",
                                                    "no",
                                                    "o",
                                                    "para",
                                                    "por",
                                                    "que",
                                                    "qué",
                                                    "se",
                                                    "sin",
                                                    "sobre",
                                                    "son",
                                                    "su",
                                                    "sus",
                                                    "tanto",
                                                    "través",
                                                    "un",
                                                    "una",
                                                    "unas",
                                                    "unos",
                                                    "vez",
                                                    "y",
                                                ];
                                                const sacaPalabras = (arreglo, sacar) => {
                                                    return arreglo.filter((palabra) => {
                                                        return !sacar.includes(palabra);
                                                    });
                                                };
                                                var palabrasAcotadas = sacaPalabras(palabras, nopalabras);
                                                const cuentaRepeticiones = (arreglo = []) => {
                                                    const resultado = [];
                                                    arreglo.forEach((el) => {
                                                        const index = resultado.findIndex((obj) => {
                                                            return obj["name"] === el;
                                                        });
                                                        if (index === -1) {
                                                            resultado.push({
                                                                name: el,
                                                                count: 1,
                                                            });
                                                        } else {
                                                            resultado[index]["count"]++;
                                                        }
                                                    });
                                                    return resultado;
                                                };
                                                var total = cuentaRepeticiones(palabrasAcotadas);
                                                total.forEach((x) => {
                                                    if (x.count >= 3) {
                                                        palabreo.innerHTML += `<span>${x.name} (${x.count})</span>`;
                                                    }
                                                });
                                            }

                                            datos("Moda").catch((error) => console.error(error));

                                            document.querySelector("select").addEventListener("change", (event) => {
                                                aqui.innerHTML = " ";
                                                visualizacion.innerHTML = " ";
                                                palabreo.innerHTML = " ";
                                                console.clear();
                                                var seleccion = [];
                                                var profes = [];
                                                var nombres = [];
                                                var barras = [];
                                                var ambitos = [];
                                                datos(event.target.value).catch((error) => console.error(error));
                                            });
                                        </script>
                                        <script>
                                            new Chartist.Line(
                                                ".ct-chart",
                                                {
                                                    labels: [2016, 2017, 2018, 2019, 2020, 2022],
                                                    series: [[6.38, 6.2, 6.45, 6.5, 6.2, 6.2]],
                                                },
                                                {
                                                    axisY: {
                                                        offset: 30,
                                                    },
                                                }
                                            );
                                        </script>
                                    </div>
                                </div>
                            </div>
                        </body>
                    </body>
                </div>
            </div>
        </div>
    </body>
</html>
